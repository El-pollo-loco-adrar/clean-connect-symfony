{% extends 'base.html.twig' %}

{% block body %}

<div class="py-12 px-4 max-w-4xl mx-auto">
<div class="flex justify-between items-center mb-8">
<h1 class="text-3xl font-black uppercase tracking-tighter italic text-gray-900">Candidatures Reçues</h1>

    {# On change le lien ici pour éviter l'erreur si app_employer_dashboard n'existe pas #}
    <a href="/" class="border-2 border-black px-4 py-2 font-bold text-sm hover:bg-black hover:text-white transition-all uppercase shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:shadow-none bg-white">
        Retour
    </a>
</div>

<div class="grid gap-6">
    {% for conv in conversations %}
        <a href="{{ path('app_chat_view', {'id': conv.id}) }}" class="block bg-white border-4 border-black p-6 shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] hover:translate-x-1 hover:translate-y-1 hover:shadow-none transition-all">
            <div class="flex justify-between items-start">
                <div>
                    <span class="text-[10px] font-black uppercase bg-black text-white px-2 py-0.5 mb-2 inline-block">
                        Mission : {{ conv.mission.title }}
                    </span>
                    <h2 class="text-xl font-bold uppercase">
                        Candidat : {{ conv.candidate.firstName }} {{ conv.candidate.lastName }}
                    </h2>
                </div>
                <span class="bg-green-400 border-2 border-black px-3 py-1 text-xs font-black uppercase">
                    {{ conv.messages|length }} échange(s)
                </span>
            </div>
            
            {% if conv.messages|last %}
                <div class="mt-4 pt-4 border-t-2 border-black border-dashed">
                    <p class="text-sm text-gray-600 truncate">
                        <span class="font-bold italic">Dernier message :</span> {{ conv.messages|last.content }}
                    </p>
                </div>
            {% endif %}
        </a>
    {% else %}
        <div class="border-4 border-black border-dashed p-12 text-center bg-gray-50">
            <p class="font-bold text-gray-500 uppercase italic">Aucune candidature pour le moment.</p>
        </div>
    {% endfor %}
</div>


</div>
{% endblock %}